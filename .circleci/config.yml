version: 2.1

orbs: 
  slack: circleci/slack@4.5.0

workflows: 
  test-deploy: 
    jobs: 
      - test
      - slack/notify:
        event: pass
        template: basic_success_1
        mentions: '@ProductTeam'

jobs:
  test:
    docker:
      - image: cimg/node:17.2.0
    steps:
      - checkout
      - run:
          name: Install deps
          command: npm i
  notify:
    docker:
      - image: 'cimg/base:stable'
        custom: |
          {
            "attachments": [
              {
                "color": "#0abc0a",
                "blocks": [
                  {
                    "type": "section",
                    "text": {
                      "type": "mrkdwn",
                      "text": "The build on *beta* has started. :large_green_circle:  "
                    }
                  }
                ]
              }
            ]
          }
        event: always